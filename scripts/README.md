# 서울 캠페인 엑셀-CSV 변환 규칙

이 문서는 `서울성수.xlsx` 파일을 CSV로 변환할 때 적용되는 규칙을 설명합니다.

## 데이터 변환 규칙

### 컬럼 정보 및 처리
1. **불필요한 열**
   - A열, B열, G열, I열, AJ열은 처리에서 제외

2. **필수 데이터 열**
   - C열 = 이름 → 참여자 데이터로 사용
   - D열 = 성별 → 성별 데이터로 사용
   - E열 = 회중 → 참여 회중 데이터로 사용
   - F열 = 출생연도 → 나이 계산에 사용 (현재 연도 - 출생연도)
   - H열 = 결혼 → 결혼 여부 데이터로 사용

3. **참여 일정 데이터 (K열~AI열)**
   - 첫 행은 날짜 정보
   - K2~AI106 범위에서 'O' 표시는 해당 날짜의 참여를 의미
   - 각 날짜별 'O' 개수는 캘린더 일정의 참여 인원 수로 사용
   - 각 참여자별 'O' 표시된 날짜는 참여일자 데이터로 사용

### 중복 참여자 처리
1. 전체 행 수(첫 행 제외) - 중복 행 = 총 참여자 수
2. 중복 참여자 판단 기준: C열(이름), D열(성별), E열(회중), F열(출생연도)가 모두 동일한 경우
3. 중복 행 처리:
   - A~J열의 데이터는 첫 행의 데이터 유지
   - K~AI열 참여 일자 데이터는 Unique하게 통합 처리

### 최종 CSV 출력에서의 중복 행 제거
1. **중요**: 동일 참여자는 여러 참여 날짜가 있더라도 CSV에 **한 행만 포함**되어야 함
2. 각 참여자의 첫 번째 참여 날짜 행만 유지하고 나머지 행은 삭제
3. '참여일자' 열에는 해당 참여자의 모든 참여 날짜가 포함되어야 함
4. 예시:
   ```
   # 다음과 같은 데이터가 있다면 (아래 4줄):
   4월 22일 화요일,충북음성,서두원,형제,41,1984,기혼,"4월 22일 화요일,4월 23일 수요일,5월 13일 화요일,5월 14일 수요일"
   4월 23일 수요일,충북음성,서두원,형제,41,1984,기혼,"4월 22일 화요일,4월 23일 수요일,5월 13일 화요일,5월 14일 수요일"
   5월 13일 화요일,충북음성,서두원,형제,41,1984,기혼,"4월 22일 화요일,4월 23일 수요일,5월 13일 화요일,5월 14일 수요일"
   5월 14일 수요일,충북음성,서두원,형제,41,1984,기혼,"4월 22일 화요일,4월 23일 수요일,5월 13일 화요일,5월 14일 수요일"
   
   # 첫 번째 행만 유지하고 나머지는 삭제:
   4월 22일 화요일,충북음성,서두원,형제,41,1984,기혼,"4월 22일 화요일,4월 23일 수요일,5월 13일 화요일,5월 14일 수요일"
   ```

## CSV 출력 형식
- 최종 CSV 파일 헤더: `날짜, 회중, 이름, 성별, 나이, 출생연도, 결혼, 참여일자`
- 각 참여자는 첫 번째 참여 날짜 행만 포함하고 나머지 행은 삭제
- 참여일자 열에는 해당 참여자의 모든 참여 날짜가 쉼표로 구분되어 포함

## 스크립트 실행 방법
```bash
node scripts/convert-excel-to-csv.js
```

이 스크립트는 `서울성수.xlsx` 파일을 읽어서 `public/data/participants.csv` 파일로 변환합니다. 